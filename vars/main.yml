---
# Role variables

login_defs_system_auth_config_file: /etc/pam.d/system-auth

login_defs_password_auth_config_file: /etc/pam.d/password-auth

login_defs_config_file: /etc/login.defs

login_defs_cracklib_pam_d_config: >-
  pam_cracklib.so try_first_pass
  retry={{ login_defs_login_retries }}
  type={{ login_defs_password_type }}
  ucredit={{ login_defs_password_ucredit }}
  lcredit={{ login_defs_password_lcredit }}
  dcredit={{ login_defs_password_dcredit }}
  ocredit={{ login_defs_password_ocredit }}

login_defs_pwquality_pam_d_config: >-
  pam_pwquality.so try_first_pass local_users_only
  retry={{ login_defs_login_retries }}
  authtok_type={{ login_defs_password_type }}
  ucredit={{ login_defs_password_ucredit }}
  lcredit={{ login_defs_password_lcredit }}
  dcredit={{ login_defs_password_dcredit }}
  ocredit={{ login_defs_password_ocredit }}

login_defs_pam_unix_pam_d_config: >-
  pam_unix.so sha512 shadow nullok try_first_pass use_authtok
  remember={{ login_defs_password_remember }}

login_defs_pam_faillock_pam_d_config_line1: >-
  auth \t    required \t pam_faillock.so preauth audit
  silent deny={{ login_defs_pam_faillock_deny }}
  unlock_time={{ login_defs_pam_faillock_unlock_time }}

login_defs_pam_faillock_pam_d_config_line2: >-
  auth \t    [success=1 default=bad] \t pam_unix.so

login_defs_pam_faillock_pam_d_config_line3: >-
  auth \t    [default=die] \t pam_faillock.so authfail audit
  deny={{ login_defs_pam_faillock_deny }}
  unlock_time={{ login_defs_pam_faillock_unlock_time }}

login_defs_pam_faillock_pam_d_config_line4: >-
  auth \t    sufficient \t pam_faillock.so authsucc audit
  deny={{ login_defs_pam_faillock_deny }}
  unlock_time={{ login_defs_pam_faillock_unlock_time }}

login_defs_pam_faillock_pam_d_config: |
  {{ login_defs_pam_faillock_pam_d_config_line1 }}
  {{ login_defs_pam_faillock_pam_d_config_line2 }}
  {{ login_defs_pam_faillock_pam_d_config_line3 }}
  {{ login_defs_pam_faillock_pam_d_config_line4 }}
