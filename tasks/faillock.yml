---
# Faillock config tasks

- block:
    - name: Include faillock auth configuration
      replace:
        path: "{{ login_defs_faillock_item }}"
        regexp: "^auth( +)sufficient( +)pam_unix.so(.*)$"
        replace: "{{ login_defs_pam_faillock_pam_d_config }}"
      loop:
        - "{{ login_defs_system_auth_config_file }}"
        - "{{ login_defs_password_auth_config_file }}"
      loop_control:
        loop_var:   login_defs_faillock_item
  tags:
    - role::login_defs::faillock
