---
# Authconfig tasks

- block:
    - name: Check if configuration files are autogenerated by authconfig
      stat:
        path: "/etc/pam.d/{{ login_defs_pam_auth_file }}"
      register: login_defs_stat_pam_auth_result
      loop:
        - password-auth
        - system-auth
      loop_control:
        loop_var: login_defs_pam_auth_file

    - include_tasks: authconfig_el.yml
      when:
        - ansible_facts.distribution | lower in ["centos", "redhat"]

    - include_tasks: authconfig_fedora.yml
      when:
        - ansible_facts.distribution | lower in ["fedora"]
  tags:
    - role::login_defs::authconfig
